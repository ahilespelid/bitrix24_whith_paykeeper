<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____1416703064']= array(base64_decode(''.'aXNfc3'.'Rya'.'W'.'5'.'n'),base64_decode('c3R'.'ydG'.'9sb3'.'d'.'lc'.'g=='),base64_decode('aXNfYX'.'JyYXk='),base64_decode(''.'aXNfc3'.'Ry'.'aW5'.'n'),base64_decode('Z3pkZWN'.'vZGU='),base64_decode(''.'YmFzZ'.'TY0X2R'.'lY29k'.'ZQ=='),base64_decode('d'.'XJsZ'.'GVjb'.'2Rl'),base64_decode(''.'Y'.'XJy'.'YXlf'.'cmV2ZX'.'JzZ'.'Q=='),base64_decode('Z3plb'.'mNvZGU='),base64_decode('Y'.'mFzZ'.'TY'.'0X2V'.'u'.'Y'.'29'.'kZQ='.'='),base64_decode(''.'dXJsZ'.'W5j'.'b2Rl'),base64_decode(''.'Ymlu'.'M'.'mhleA=='),base64_decode('aX'.'N'.'fYXJy'.'Y'.'Xk='),base64_decode('c3Ry'.'dG9'.'sb3dlcg=='),base64_decode('aXN'.'fYXJ'.'yYXk='),base64_decode('am9pbg=='),base64_decode('Z'.'m5tYXRjaA=='),base64_decode('cmF3d'.'XJsZG'.'Vjb2Rl'),base64_decode('c3'.'Vic3Ry'),base64_decode('c3'.'Vic3Ry'),base64_decode('c3RyX3Jlc'.'GxhY2U='),base64_decode(''.'cHJlZ'.'19xdW90ZQ='.'='),base64_decode('c'.'H'.'JlZ'.'19'.'t'.'Y'.'X'.'Rj'.'aA=='));if(!function_exists(__NAMESPACE__.'\\___1858939151')){function ___1858939151($_1912011577){static $_1374734112= false; if($_1374734112 == false) $_1374734112=array('Y'.'WN0aW9u',''.'a'.'W50'.'dm'.'Fs','cGF0aA='.'=','Y29udGV4dA='.'=','a2V5'.'cw='.'=','cHJvY2Vzcw==','ZW5jb2'.'R'.'pbmc=',''.'cHJlZ'.'19yZXBs'.'YWNl','cGF0aA==','Y29u'.'dGV4dA'.'==','a2V5c'.'w==','cHJvY2Vzcw==','ZW5jb2Rpbm'.'c=','cGF0dG'.'Vybg='.'=','cHJ'.'lZ19tYX'.'RjaA==','cG'.'F0a'.'A==',''.'Y29udGV'.'4dA'.'='.'=','a'.'2V5'.'cw='.'=',''.'cHJ'.'vY2'.'Vzcw==','ZW5jb2Rpbmc=','cGF0'.'dGVyb'.'g'.'==','c'.'G9zdF9hY3Rpb24'.'=','Y2hlY'.'2'.'t'.'fY3NyZg'.'==','cGF0aA==','Y29'.'udGV'.'4dA==','a2V5cw==','c'.'HJv'.'Y'.'2'.'Vzcw='.'=','ZW5jb2Rpbmc=','cGF0dGVybg==','YWN0aW9u',''.'YWN0'.'aW9u','Y'.'WN0aW'.'9u','YWN0aW9u','Y'.'WN'.'0'.'aW9u','YWN0aW9'.'u','c'.'G9zdF9'.'h'.'Y3Rpb24=','ZW5jb2'.'Rpbm'.'c=','ZW5j'.'b2Rpbmc=','Z'.'W5jb2'.'Rp'.'bmc=',''.'ZW'.'5jb2Rpbmc'.'=','ZW5jb2Rpbm'.'c'.'=',''.'ZW5j'.'b2'.'R'.'pbmc=',''.'Z3o'.'=',''.'Y'.'mFzZTY0','dXJs',''.'aG'.'V4','Lg==','Lw'.'==','aW5kZ'.'XgucGhw','L'.'2luZGV4'.'Ln'.'Boc'.'A==','U0NS'.'SVBUX05B'.'TUU=','L2'.'l'.'u'.'ZGV4L'.'n'.'Boc'.'A'.'==','U0NSS'.'V'.'BU'.'X05B'.'TUU=','U0NS'.'SVB'.'U'.'X'.'05B'.'TUU=',''.'U0'.'NSS'.'VB'.'U'.'X05BT'.'UU'.'=','f'.'g='.'=','fl4'.'=',''.'fg'.'==','X'.'H4=','JH4=');return base64_decode($_1374734112[$_1912011577]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_1278590717; protected $_836321206; protected $_564565875; protected $_1061556336; protected $_232763631; public static function make(array $_1832938302):?static{ $_1832938302= static::prepareRuleParameters($_1832938302); return match($_1832938302[___1858939151(0)]){ ___1858939151(1) => new IntvalRule( $_1832938302[___1858939151(2)], $_1832938302[___1858939151(3)], $_1832938302[___1858939151(4)], $_1832938302[___1858939151(5)], $_1832938302[___1858939151(6)]), ___1858939151(7) => new PregReplaceRule( $_1832938302[___1858939151(8)], $_1832938302[___1858939151(9)], $_1832938302[___1858939151(10)], $_1832938302[___1858939151(11)], $_1832938302[___1858939151(12)], $_1832938302[___1858939151(13)]), ___1858939151(14) => new PregMatchRule( $_1832938302[___1858939151(15)], $_1832938302[___1858939151(16)], $_1832938302[___1858939151(17)], $_1832938302[___1858939151(18)], $_1832938302[___1858939151(19)], $_1832938302[___1858939151(20)], $_1832938302[___1858939151(21)]), ___1858939151(22) => new CsrfRule( $_1832938302[___1858939151(23)], $_1832938302[___1858939151(24)], $_1832938302[___1858939151(25)], $_1832938302[___1858939151(26)], $_1832938302[___1858939151(27)], $_1832938302[___1858939151(28)],), default => null,};} protected static function prepareRuleParameters(array $_1599882065): array{ if($GLOBALS['____1416703064'][0]($_1599882065[___1858939151(29)])){ $_1599882065[___1858939151(30)]= $GLOBALS['____1416703064'][1]($_1599882065[___1858939151(31)]);} elseif($GLOBALS['____1416703064'][2]($_1599882065[___1858939151(32)])){ $_1741922046= $_1599882065[___1858939151(33)]; $_1599882065[___1858939151(34)]= $_1741922046[min(86,0,28.666666666667)]; $_1599882065[___1858939151(35)]= $_1741922046[round(0+0.25+0.25+0.25+0.25)];} $_1599882065[___1858939151(36)]=!empty($_1599882065[___1858939151(37)])? $_1599882065[___1858939151(38)]:[]; if($GLOBALS['____1416703064'][3]($_1599882065[___1858939151(39)])){ $_1599882065[___1858939151(40)]=[$_1599882065[___1858939151(41)]];} return $_1599882065;}  public function __construct($_1278590717, $_836321206, $_564565875, $_1061556336, $_232763631){ $this->_1278590717= $_1278590717; $this->_836321206= $this->castContext($_836321206); $this->_564565875= $this->castKeys($_564565875); $this->_1061556336= $_1061556336; $this->_232763631= $_232763631;} public function evaluateValue($_257618998){ if(!empty($this->_232763631)){ foreach($this->_232763631 as $_2031172698){ $_257618998= match($_2031172698){ 'gz' => $GLOBALS['____1416703064'][4]($_257618998), 'base64' => $GLOBALS['____1416703064'][5]($_257618998), 'url' => $GLOBALS['____1416703064'][6]($_257618998), 'hex' => hex2bin($_257618998)};}} $_2095289076= $this->evaluate($_257618998); if(!empty($this->_232763631) && $_2095289076 instanceof ModifyResult){ $_227533162= $_2095289076->getCleanValue(); foreach($GLOBALS['____1416703064'][7]($this->_232763631) as $_2031172698){ $_227533162= match($_2031172698){ ___1858939151(42) => $GLOBALS['____1416703064'][8]($_227533162), ___1858939151(43) => $GLOBALS['____1416703064'][9]($_227533162), ___1858939151(44) => $GLOBALS['____1416703064'][10]($_227533162), ___1858939151(45) => $GLOBALS['____1416703064'][11]($_227533162)};} $_2095289076= new ModifyResult($_227533162);} return $_2095289076;} abstract public function evaluate($_257618998); protected function castContext($_836321206){ if(!$GLOBALS['____1416703064'][12]($_836321206)){ $_836321206=[$_836321206];} foreach($_836321206 as $_1906037292 => $_963887684){ $_836321206[$_1906037292]= $GLOBALS['____1416703064'][13]($_963887684);} return $_836321206;} protected function castKeys($_564565875){ if(!$GLOBALS['____1416703064'][14]($_564565875)){ $_564565875=[$_564565875];} return $_564565875;} public function matchKey(array $_1732708784): bool{ $_1732708784= $GLOBALS['____1416703064'][15](___1858939151(46), $_1732708784); foreach($this->_564565875 as $_101361554){   if($GLOBALS['____1416703064'][16]($_101361554, $_1732708784)){ return true;}} return false;}  public function matchPath($_710117021){ if($this->_1278590717 === '*'){ return true;}  $_1678521384= new Uri($_710117021); $_1006711173= $_1678521384->getPath(); $_1006711173= $GLOBALS['____1416703064'][17]($_1006711173);      if(str_ends_with($_1006711173, ___1858939151(47))){ $_1006711173 .= ___1858939151(48);} $_1006711173= Path::normalize($_1006711173);  $_168544766[]= $_1006711173; if(str_ends_with($_1006711173, ___1858939151(49))){ $_168544766[]= $GLOBALS['____1416703064'][18]($_1006711173,(790-2*395),-round(0+9));} elseif(str_ends_with($_SERVER[___1858939151(50)], ___1858939151(51))){ $_168544766[]= $GLOBALS['____1416703064'][19]($_SERVER[___1858939151(52)],(838-2*419),-round(0+9));} if($_1006711173 !== $_SERVER[___1858939151(53)]){ $_168544766[]= $_SERVER[___1858939151(54)];}  if(str_starts_with($this->_1278590717, ___1858939151(55))){ $_1555305753= $this->_1278590717;} else{ $_1555305753= ___1858939151(56). $GLOBALS['____1416703064'][20](___1858939151(57), ___1858939151(58), $GLOBALS['____1416703064'][21]($this->_1278590717)). ___1858939151(59);} foreach($_168544766 as $_1600448836){ if($this->_1278590717 === $_1600448836 || $GLOBALS['____1416703064'][22]($_1555305753, $_1600448836)){ return true;}} return false;}  public function getPath(){ return $this->_1278590717;}  public function getContext(){ return $this->_836321206;}  public function getKeys(){ return $this->_564565875;}  public function getProcess(){ return $this->_1061556336;}}?>